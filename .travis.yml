sudo: required
language: node
cache:
  directories:
  - node_modules
  - public/videos
  - ~/google-cloud-sdk
env:
  global:
  - secure: YcZTCqPR2u9xi76hGaJtkR2zrF7y6QBXwxXYTQXLFjaxst75udDYQE1SHLuB/83sXyvLQIlApJ8tdJTO4Q/diPiRLXHyxy8s9GKBsEVlhB9fqFMFk3nQ6P9ydtEiEXE0krTuaCyWuBE6ulL9H6AAY9EWKmbWD00i7HInO1whuHsugu8BPk946KYq3uL1OIRx8rpLSc3OMoCQFOkyrwY/LdrMWSeECTxZA+qJHs34mobFlWtjDWipfJ1zzk+l83boLKoJ0+5tB8kc/cR2v4v9C8A2kMfY+R6lBQ+gz3zOMVlIR8/TXcwB0nBu8+VAT7qhr6Xzlns/3BcuC6nEjeQR1+gcPXGLg6RHgsQuT0uEf/E/oJO1f61iWGpZRIdnNvmJQrqj9DhaG0MMbSV2nz37jYotwFYDfP4ulLI+DjKkJa7glXJ8MNhOjJt58HA+2GHfDXgBfZ1IKV9+qCC3GZASvfOiKO+H5zUDrd/CFyOZQx/8ibs7fcLrQHq3GAkRXBQqwIjlLHmyHVddV+eA2AyClDdgcWzOxPnKS1jr8HuXCx2M6v1JrRxqy1b2qBeRKqBWisKo0O67hAqGQ4f2/OkdBu76CLePvrHiIuX8SEUneUdjhX2JZcpyiOFKLAHOPxBgKi9XXCm1eKAPHbekVI4Tzv2EhC5ta1W/t6IBvjucNs4=
  - secure: 4rece59fI1q58BqR9GASz0+JUut/YLuFPH9vUJ9bwnP+yM/GZOYNehbclkUdM+O3bR3NCk3+lagNL1Jn5+3xT29N/SjINliOa7VWBmdkbRtBc1WHlS6XqyNG+yZcbe8VZbk7Ps6gtTpImprO1Cf+x9sbeO1GZNyocObEB/PAclKbm5Y07kR58EL7vkMqn80P/GlNGhL7faMg00OhXAjhIKwdwruWB9rveNEICK7hnSIz4G2kzSEQgNuTjv2dNiIiE7GWZXRdiNCHLNCknhRjf2c+5E3W1R8P+C0QHujLx4wmPwOFjYQfw57Yx+9paaBcIGH4/c6TmHjQCCGUbVuc6mUfuZuk9nJHxPtJR/3a7sFmqE0g0jb/hKcMk87jehddUPbbDzHK9myMV4Wevr3rWV9HhW/ve+5hqYzFHLnh7D3yb+2LZ3m3m5fTmHo2thi1SVvup//AcF5HlkvnzsciwEckr8zU0TOJ6E4DnFTycKCk+l4GzyI7i1YnqFvpr1SebfaluQtdIidgzNRfjAiE1qLZRJ2sr9VnxEJ1oZUhK4mnMu61vvhybRq77wGFJlV+NKQlTCOmLwwK87xhfT5p/BSZy0TBpiseR2kFU+SFO3TqXlazscnCooTUDw5Vor9ovf2hj6DKbUUZeCzjczsXW6yX5I/RPaLhKiYuBTt73/U=
  - secure: 2/+qockrKYzUIrtmTdI3zyGALST0cyJsQMrzqi2HLTkbWuHn9ErEnCkxGHKwUhUPB7EFXDULRLF+8m/MN8mhnkc2K8WrUVu63EBCAXPp7Tw4c1C7POgoMOf+UwWrHx3ofqUWgfEGToEort47zYaC8KpbKWhJXoMCGsijccDFydwNeruLL/Ze7c3suwf/zHfvdODtmXKcm/u21sZiObotE8yoxpPo2dqtM6QkRKps++boPUS81gt0xsGQy0/daB0zKG6L9wh/r9bt3a1i4p2Pwe4kJfLg6eYgq4oeOCwg5ONhZlIOoPXbJXL7xVCWjYvZEMHx7Vo1P4uDhTjHPu/43I8fgRBqMQAaS1HEujuFuGQA4FGIF99i4SgmpLDkSarxjA8ucstIykZ9Dm8b7TAu13XV5vv9dWc8+FvxKjL1U9Xsxf8p8BgcujWMQHHNKjMGp3+eE2s1d8P+B5S7r9V+boSFCTx641ma1O3oSo2cd/Ltu22lKfn5L0SwrW0X/ZB6yLei4Kt3r4kIEH8cUXXhQ8s0aN1xUgyrT04FFgKCtNFzj5PqeLxtBufWrY/OZo6b8I0yFyHVvrNPshgAEP14uEsuDE2DMaczHPXM1WamVVStPVyqMNl9dRbFx4jwftKOW3keH9uiyr50wW5SbFWD9yfmxo0eGUaBXnO9snCmNZY=
  - secure: b00Mqc9jWhmXp0xgh+eYuj0c74cNP19C+yaMHODx6tzU28N8LDOWWgmXaxceSyIxePg6oLoKch0WQfIfuHFGLOPQ2v3YQgFwZ7oIsiHR8LEvcCmrkcfRDuVC4nQMhFjxc38NnxwiTmbwjr6kBXrFceNROvDiGUKJ6h6cntl0bcqfQgvo0Thp+DEdz6WaimOiKg391b+MbBJHk7nK1x+XNMmWbZ3RDg17T0f9rHcnDUtNgO4yVxPpzD7VllSQk0LRmHZyoISVndkTOYbxmEmmmnHgqrdwpCt/bveuJN72ieg8DkcGUrpoBNCVZVzrjwrze6kBQDNUA9+reZ7rpgfTeLYJ/DbKk2oixcaMC/2tUqZG+piqXf6tTl6apq801ibpHx3tMXdLSqmJgCDjZXK0Lzn30CzYQ8+LAGALJFpGDa9v9Mt1hmMtfXBf/pVTJTQOJl/jKIV62SabzBIGGiqKr+rUPd4/i5h0j+Q//9ZfF8L1VmrDwAodGKPSUq9Ek+GGs/VJ8gekkCBoC9wH1IPG8ozvdP653RjelIfsbuspS5e9tKxfGWnYLw4LWwx4HQnLVEPK/9Id8wmITdSUQf3I/YRzCEMbJWdzLv6P9uYt83vXeTtfBO70v/vguO/wjG/tqqI8dC36cOvxHTKwQx1tFho3Pkhs3PDc+cmeC7MDAFU=
  - secure: L+q7hoAHDFsYnHey1RTgpLr6iXFdKWTli9hgQ/+YB3e8J/ZZ1Lx2llwhKAPOxOOyimLrmPVcDuseYYgG62DlNGUNOJb4n5YS81hdyur2k0Z1NGinANRyaqGjne/43BtOrafa/GSidx2UAk7C34GSAi3hSrBRi4qMebYOqnkSv4hCQhGKKphooixW3DopHsAU9xhlYtmeszQ45KV8PgwfCITnv1vvIh6a2rVNN1Z1gdJGZeEsw0IiBExKtJSZQl69BYtXVNWfDH6Gv1Z9c1cetwPUXah1BJnckf3fEOTvIxcfL0wTezr2BpHb0FWoyuqdKtzV2G/nJcVzJV27pF65LDMZ8FSBUAvDDp/S1GOqM4ZlPpxguF7MPfGZNhrzXEXxMNp2ADoTw2Dczhy+A1qG+aihdffVA+MxnogDMnsFSpwlM7jK5Mi1BW6nH2p0MxycyjglN5x7NXBXQcRCHek/A0U9EWfrCNRWaqEDxCmRNfM3hRKfXp6S0Icu2R/BetMYA9P2agk68IoFAmec6lZQg2J301xaR8QA34y4aEdX+R5pGaaSnz3P08IcqcXAltpi/y127RpyN7jWM3GgJN7Atzex7khrbfuaq+mtvAvIB3yQ2+hiv4MpfIvYrXpp0T1jqAG/TkVdxtBQET/Kb801ThdUliHJYYtI49ILaboPvW8=
  - secure: nALuDdnyr+qSePtE8f7DQDWBUTvnHMlviVRW+3wLHmK6I7CC2aq9YaJJYZYtDPbDRYnGFukjsMW64K6ZBoAsA9X6ktB0WslDZvZ1+o+qpguOdLZ6oPL/Trrrt2z7OPCQum4njllH6z2+kxFgs2coprIpoflJPI78DWL7XkuKamiWiP8VJd2ybHSqVvqwTWvJuZjcj+3j1FPA8AOwRdi654bRLl5TQFV/pwAdLwf0esMwbiIJd2+AeM//mp0Rc0SE6X7D1kY7ssYg9iOcNL1LSo06zHQSepVjLht9rTKo/nvgF/wi5PtBK3ARVUIgkVKhfZEqps6pATfumg6ZI+GVz2XHaKuBVc1UUrK946I/8rRHOzOQfx/q55EDOrZRtKZNpdptexjbFgs1BWz/tN5sBF0Td3WOR+BUguU9963L4TXk/SrqaydAjutQ6uPSf774PnngPSwwXW5h1867TOkDzmpoIc9ke0fBcMCSqvL7BoHRXmwPZd0NjAU/4ZQEz3KMmfaIrsfDz6PK2Ncs+4B9rJqw2gOsSDdbCx2E054hxPnK9bfvGvg9IjwrggzBWmJFopZmdoxmbiiKBMzY801oHbAxW+rVMmMdZMna5gfcl0J1d9ZI8jBZ2mru22eUtW6M1aCwDu9E3+FntI5b3vnFj2H+6GmgXeKfVoAKtO+6zd4=
  - secure: Pa36urkub2teejUlebKtbvphTg58dUoK1jz/89n4VA0jjLiZmbbM6baMZihlw2qJ5os8xzsgN1yztE5QMB1/BaVKfSMTwVnRS+HvjyJsnmVy/e8+Grw1q2N/3CpFuCnyKszU8P+cKqW23Oo+YLeAarEkVZA6EM8+e2G0khqLvPuiMaXnsvOxF4qn+PX1yvEMg0V685+wErSqwWGTJPKlr6CYUnEdZngRKAoRZMTgkWN7CWRJlmzrE+IRGhkh31VXUggax9reQaK4rVtxGc3iT6Sga1JBqm31xH0VmqMySJjRgnJK3djfPTmB4a/JKM7vfHFy2HvUssrALNcK6FlLhK0pSamypufT0XBCGupaGM2W2EYfLQwBcblmmCxnb4Z1GWzh5nMxZmgEo4TzOVB348iBoP4dUAby4IW+c+53GP1avDIZBsNDueteXISmQK+9S/FBdUwgUSNc0bFnrSlY5y3l4b8rwn0QWiNHYNZ1YzZ6TfJi40yavoa4GRzAlpbXDDBZE/f/mibXznlMMZvnt3CT2GkvWRto2wIPPzMjmgZqGjJy/zz/iaHNBD9pb29qURwBgtGwdHAiaCGdojiVrSiuPGb8cU0EyZ4IH1qoC2nA0z2/g2TsquxII8C5MoMS5wGYUh6PKTYq91l+urz04Bb3/yfOZzkPeL6pcvqxeAY=
services:
- docker
script:
- ./scripts/travis.sh
deploy:
  provider: script
  script: ./scripts/deploy.sh
  on:
    branch: master
before_install:
- openssl aes-256-cbc -K $encrypted_3c0236424301_key -iv $encrypted_3c0236424301_iv
  -in credentials.tar.gz.enc -out credentials.tar.gz -d
- if [ ! -d ~/google-cloud-sdk/lib ]; then rm -r ~/google-cloud-sdk && curl https://sdk.cloud.google.com
  > ~/gcloud.sh && chmod +x ~/gcloud.sh && ~/gcloud.sh --install-dir=${HOME} --disable-prompts;
  fi
- tar -xzf credentials.tar.gz
- gcloud auth activate-service-account --key-file gcloud-credentials.json
